
@{
    ViewBag.Title = "Log In";
    string errorMsg = "";
}
@section styles{
    <style type="text/css">
        #ch_password .has-error .field-validation-error{
            background-color:#3c464b !important;
        }

        .nts-button.B1 a, .nts-button.B a{
            display:inline-table !important;
        }
    </style>
}
 
    <div class="nts-single-purpose-introduction-wrapper">
        <div class="nts-gradient-top-bottom"></div>
        <div class="nts-chapter nts-single-purpose-introduction nts-smartpanel smartpanel nts-adaptive-image container-fluid preview smartpanel " style="background-image: url(../../Content/images/bg1.jpg);height:550px;">
            <div class="nts-gradient-top-bottom"></div>
            <div class="nts-single-purpose-introduction-image-mobile hidden-md hidden-lg">
                <img class="nts-adaptive-image" src="@Url.Content("~/Content/images/bg1.jpg")" alt="">
            </div>
            <div class="nts-single-purpose-introduction-content">

                <!-- ignore .dark-text from darkBackground to ensure text visibility of Conversion Button Text on white editing background -->
                <div class="container nts-single-purpose-introduction-box-container ">
                    <div class="row nts-single-purpose-introduction-box-row hidden-xs hidden-sm">
                        <div class="col-lg-12">
                            <div class="nts-breadcrumb hidden-xs hidden-sm" data-ste-component="navigation_breadcrumb">
                                <ul class="nts-breadcrumb-list">
                                    <li class="nts-breadcrumb-entry N4">
                                        <a href="#" class="N4">
                                            <span class="icon-home"></span>
                                        </a>
                                        <span class="icon-arrow-right-extrasmall"></span>
                                        <span class="icon-arrow-down-extrasmall"></span>
                                        <ul class="nts-breadcrumb-child-list">
                                            <li class="nts-breadcrumb-child-entry">
                                                <a href="#" class="N6"><span class="icon-arrow-right-small icon-left hover-indicator"></span>3i管理平台</a>
                                            </li>
                                        </ul>

                                    </li>
                                    <li class="nts-breadcrumb-entry N4">
                                        <a href="#" class="N4">
                                            <span>3i管理平台</span>
                                        </a>
                                        <span class="icon-arrow-right-extrasmall"></span>
                                        <span class="icon-arrow-down-extrasmall"></span>
                                    </li>
                                    <li class="nts-breadcrumb-entry N4">
                                        <span class="N4">
                                            <span>Log In</span>
                                        </span>
                                    </li>
                                </ul>
                            </div>

                        </div>
                    </div>

                    <div class="row nts-single-purpose-introduction-box-row nts-smartpanel-spacing">
                        <div class="nts-single-purpose-introduction-box-gradient col-md-7 col-lg-6">
                            <div class="col-xs-12 nts-single-purpose-introduction-box dark-text">
                                <div class="nts-single-purpose-introduction-box-headlines nts-box-gradient">
                                    <div class="col-md-10 col-lg-12 nts-single-purpose-introduction-box-headline">
                                        <div class="nts-comp nts-h1 container">
                                            <div class="row">
                                                <div class="col-lg-9">
                                                    <h1 class="H1">
                                                        <span class="H1">3i管理平台</span><div class="nts-icon-share visible-lg">
                                                            <div>
                                                                <i class="nts-share-icon nts-share-button icon-share-newton-android"></i>
                                                                <div class="nts-share-links" style="display: none;">
                                                                    <ul>
                                                                        <li>
                                                                            <div class="nts-share-links-headline">
                                                                                <i class="nts-share-icon icon-share-newton-android"></i> <span class="H4">Share this Site</span>
                                                                            </div>
                                                                        </li>
                                                                        <li>
                                                                            <a href="mailto:?subject=Recommendation%20Siemens%20Global%20Website&amp;body=The%20following%20page%20from%20the%20Siemens%20Global%20Website%20has%20been%20recommended%20to%20you%3A%0A%0Ahttps%3A%2F%2Fwww.siemens.com%2Fglobal%2Fen%2Fhome%2Fcompany%2Finnovation.html" data-ste-link-id="0000000000.:1125953604.company%2Finnovation.html">
                                                                                <i class="icon-email"></i>
                                                                                <span class="P">Email</span>
                                                                            </a>
                                                                        </li>

                                                                        <li>
                                                                            <a href="http://www.facebook.com/share.php?u=https%3A%2F%2Fwww.siemens.com%2Fglobal%2Fen%2Fhome%2Fcompany%2Finnovation.html&amp;t=siemens.com" target="_blank" rel="noopener" data-ste-link-id="0000000000.:0616537164.vation.html&amp;t=siemens.com">
                                                                                <i class="icon-facebook"></i>
                                                                                <span class="P">Facebook</span>
                                                                            </a>
                                                                        </li>

                                                                        <li>
                                                                            <a href="http://twitter.com/share?url=https%3A%2F%2Fwww.siemens.com%2Fglobal%2Fen%2Fhome%2Fcompany%2Finnovation.html" target="_blank" rel="noopener" data-ste-link-id="0000000000.:1373514906.company%2Finnovation.html">
                                                                                <i class="icon-twitter"></i>
                                                                                <span class="P">Twitter</span>
                                                                            </a>
                                                                        </li>

                                                                        <li>
                                                                            <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Fwww.siemens.com%2Fglobal%2Fen%2Fhome%2Fcompany%2Finnovation.html&amp;title=siemens.com" target="_blank" rel="noopener" data-ste-link-id="0000000000.:1469334360.on.html&amp;title=siemens.com">
                                                                                <i class="icon-linkedin"></i>
                                                                                <span class="P">LinkedIn</span>
                                                                            </a>
                                                                        </li>

                                                                        <li>
                                                                            <a href="https://plus.google.com/share?url=https%3A%2F%2Fwww.siemens.com%2Fglobal%2Fen%2Fhome%2Fcompany%2Finnovation.html" target="_blank" rel="noopener" data-ste-link-id="0000000000.:0746049277.company%2Finnovation.html">
                                                                                <i class="icon-google"></i>
                                                                                <span class="P">Google</span>
                                                                            </a>
                                                                        </li>

                                                                    </ul>
                                                                </div>
                                                            </div>
                                                        </div>

                                                    </h1>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                              
                            </div>
                        </div>

                        <div id="login" class="nts-single-purpose-introduction-form-container dark-text col-xs-12 col-md-4 col-lg-4 ">
                            <h4 class="H4">Log In</h4>
                            @using (Html.BeginForm("Login", "Account", new { ReturnUrl = ViewBag.ReturnUrl }, FormMethod.Post, new { @class = "nts-form" }))
                            {
                                @Html.AntiForgeryToken()
                                @Html.ValidationSummary(false, "", new { @class = "text-danger" })
                                <div class="input-div" data-placeholder="Username">
                                    @Html.TextBox("LoginAccount", "", new { @class = "F1" })
                                    <label id="spanLoginAccount" class="error"></label>
                                </div>
                                <div class="input-div" data-placeholder="Password">
                                    @Html.Password("LoginPswd", "", new { @class = "F1", @autocomplete = "new-password" })
                                    <label id="spanLoginPswd" class="error"></label>
                                </div>
                                @*
                                    <div class="link-div">
                                        <a class="Ad" href="#"><i class="icon-arrow-right-small"></i>忘记密码</a>
                                    </div>
                                    <div class="link-div">
                                        <a id="register" class="Ad" href="#"><i class="icon-arrow-right-small"></i>立即注册</a>
                                    </div>
                                *@
                                <input type="hidden" value="0" id="needUpdateHidFlag" name="needUpdateHidFlag" />
                                <div class="nts-single-purpose-introduction-button-container nts-button B col-lg-10  col-md-12 toright">
                                    <button type="submit" style="display:none" id="btnLogin"></button>
                                    <a href="javascript:;" title="Log In" onclick="login()">
                                        <div class="nts-button-container col-lg-12">
                                            <table>
                                                <tbody>
                                                    <tr>
                                                        @*<td class="button-icon">
                                                            <div class="pull-left icon-left icon-log-in"></div>
                                                        </td>*@
                                                        <td>
                                                            <div class="nts-button-text">Log in to Simens VSS</div>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </a>
                                </div>

                                <div class="link-div col-xs-12 alignright" style="margin-top: 40px;">
                                    <a id="gotopass" class="Ad" href="javascript:void(0);"><i class="icon-arrow-right-small"></i>Forgot Password</a>  <br />
                                <a id="gotopass1" class="Ad" href="javascript:void(0);"><i class="icon-arrow-right-small"></i>Change Password</a>
                                
                                </div>
                                
                            }
                        </div>


                        <div id="ch_password" class="nts-single-purpose-introduction-form-container col-xs-12 col-md-4 col-lg-4 ">
                            <h4 class="H4">Change Password</h4>
                            <form class="nts-form" id="changpwdForm" style="padding-bottom: 0px;">
                                <div class="input-div " data-placeholder="Username" style="padding-bottom: 0px;margin-top:40px;">
                                    <input name="ResetLoginName" id="ResetLoginName" type="text" class="F1" />
                                    @*<span id="spanResetLoginName" class="field-validation-error"></span>*@
                                </div>
                                <div class="input-div" data-placeholder="Old Password" style="padding-bottom: 0px;margin-top:40px;">
                                    <input name="ResetPassword" type="password" id="ResetPassword" class="F1" />
                                    @*<span id="spanResetPassword" class="field-validation-error"></span>*@
                                </div>
                                <div class="input-div" data-placeholder="New Password" style="padding-bottom: 0px;margin-top:40px;">
                                    <input name="ResetNewPassword" type="password" id="ResetNewPassword" class="F1" />
                                    @*<span id="spanResetNewPassword" class="field-validation-error"></span>*@
                                </div>
                                <div class="input-div" data-placeholder="Confirm New Password" style="padding-bottom: 0px;margin-top:40px;">
                                    <input name="ResetReNewPassword" type="password" id="ResetReNewPassword" class="F1" />
                                    @*<span id="spanResetReNewPassword" class="field-validation-error"></span>*@
                                </div>
                                <div class="nts-single-purpose-introduction-button-container nts-button B col-lg-6  col-md-12 toright">
                                    <a href="javascript:void(0)" title="Save" id="btn_pass" onclick="ChangePwd()">
                                        <div class="nts-button-container col-lg-12  ">
                                            <table>
                                                <tbody>
                                                    <tr>
                                                        @*<td class="button-icon">
                                                            <div class="pull-left icon-left icon-log-in"></div>
                                                        </td>*@
                                                        <td>
                                                            <div class="nts-button-text">Save</div>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </a>
                                </div>
                                <div class="nts-single-purpose-introduction-button-container nts-button B col-lg-6  col-md-12 toright">
                                    <a href="javascript:void(0)" title="Back" id="" onclick="BackToLogin()">
                                        <div class="nts-button-container col-lg-12  ">
                                            <table>
                                                <tbody>
                                                    <tr>
                                                        @*<td class="button-icon">
                                                            <div class="pull-left icon-left icon-log-in"></div>
                                                        </td>*@
                                                        <td>
                                                            <div class="nts-button-text">Back</div>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </a>
                                </div>
                            </form>

                        </div>

                    </div>
                </div>

            </div>
        </div>
    </div>
 
@section scripts
{
    <script src="@Url.Content("~/Scripts/jquery.validate.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/jquery.form.js")"></script>



    <script>
        $(function () {

            $('#LoginPswd').bind('input propertychange', function () {
                ResetInputDivStyle();
            });

            ResetInputDivStyle();
            PassValidateForm();

            $('#ch_password').hide();
            $('#gotopass,#gotopass1').click(function () {
                $('#login').hide();
                $('#ch_password').show();
            });

            $("div").removeClass('has-error');
            $('form span').text('');


            var errorMsg = '@errorMsg';
            if (errorMsg) {
                var errors = errorMsg.split(';');
                for (var i = 0; i < errors.length; i++) {
                    var error = errors[i];
                    if (error) {
                        var key = error.split(':')[0];
                        var value = error.split(':')[1];
                        if ($('#span' + key).length) {
                            $('#span' + key).text(value);
                            $('#span' + key).parent().addClass('has-error');
                            $('#LoginPswd').val('');
                            ResetInputDivStyle();
                        } else {
                            siemensCfg.simpleAlert(value, 2);
                            $('#LoginPswd').val('');
                            ResetInputDivStyle();
                            break;
                        }
                    }
                }
            }
            @*if('@Model.NeedUpdatePswd' == 'True'){
                SiemensVSSCfg.simpleConfirm(null, "Confirm to log in without changing your initial password?", null, function () {
                    $('#needUpdateHidFlag').val(1);
                    login();
                });
            }*@
        });

        function BackToLogin() {
            $('#login').show();
            $('#ch_password').hide();
        }
        //验证
        function PassValidateForm() {
            passFromVail = $("#changpwdForm").validate({
                rules: {
                    ResetLoginName: {
                        required: true,
                        maxlength: 200
                    },
                    ResetPassword: {
                        required: true,
                        maxlength: 20,
                        minlength: 6
                    },
                    ResetNewPassword: {
                        required: true,
                        maxlength: 20,
                        minlength: 6
                    },
                    ResetReNewPassword: {
                        required: true,
                        maxlength: 20,
                        equalTo: '#ResetNewPassword',
                        minlength: 6
                    }
                },
                messages: {
                    ResetLoginName: {
                        required: 'Username could not be empty',
                        maxlength: 'Username could not exceed 200 characters'
                    },
                    ResetPassword: {
                        required: 'Old Password could not be empty',
                        maxlength: 'Password length could not exceed 20 characters',
                        minlength: 'Password length must be at least 6 characters'
                    },
                    ResetNewPassword: {
                        required: 'New Pasword could not be empty',
                        maxlength: 'Password length could not exceed 20 characters',
                        minlength: 'Password length must be at least 6 characters'
                    },
                    ResetReNewPassword: {
                        required: 'Confirm New Password could not be empty',
                        maxlength: 'Password length could not exceed 20 characters',
                        equalTo: 'Password does not match',
                        minlength: 'Password length must be at least 6 characters'
                    }
                },
                errorPlacement: function (error, element) {
                    error.appendTo(element.parent());
                    if (!element.parent().hasClass("has-error")) {
                        element.parent().addClass("has-error");
                    }
                    element.parent().hasClass("has-error");
                },
                success: function (label) {
                    if ($(label).parent().hasClass("has-error")) {
                        $(label).parent().removeClass("has-error");
                    }
                    $(label).remove();
                }
            });
        }

        function login() {
            $('.input-div').removeClass('has-error');
            $('.input-div').find('label.error').remove();
            SiemensVSSCfg.simpleLoading();
            $('#btnLogin').click();
        }

        function ChangePwd() {
            $('.input-div').removeClass('has-error');
            $('.input-div').find('label.error').remove();
            if ($("#changpwdForm").valid()) {
                $.ajax({
                    type: "post",
                    url: "@Url.Action("ChangePassword", "Account")",
                    data: $("#changpwdForm").serialize(),
                    // async: false,
                    dataType: "json",
                    success: function (json) {
                        if (json.Status == 0) {
                            SiemensVSSCfg.simpleAlert(json.Message, 1, "@Url.Action("Login", "Account")");
                        }
                        else {
                            SiemensVSSCfg.simpleAlert(json.Message, 2);
                        }
                    }
                });
            }
        }
    </script>
}